{"paragraphs":[{"text":"import org.apache.kafka.clients.consumer.KafkaConsumer\nimport org.apache.kafka.clients.producer.{Callback, KafkaProducer, ProducerRecord, RecordMetadata}\nimport scala.collection.JavaConverters._","user":"admin","dateUpdated":"2019-02-09T18:20:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.kafka.clients.consumer.KafkaConsumer\nimport org.apache.kafka.clients.producer.{Callback, KafkaProducer, ProducerRecord, RecordMetadata}\nimport scala.collection.JavaConverters._\n"}]},"apps":[],"jobName":"paragraph_1549720857658_1354931753","id":"20190209-140057_1408086904","dateCreated":"2019-02-09T14:00:57+0000","dateStarted":"2019-02-09T18:20:45+0000","dateFinished":"2019-02-09T18:21:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:232"},{"text":"\n\nval inTopic = \"in\"\nval outTopic = \"out\"\nval brokerList = List(\"ip-10-0-10-152:6667\", \"ip-10-0-10-251:6667\").mkString(\",\")\n\nval producer = new KafkaProducer[String, String](\n        Map[String,Object](\n          \"key.serializer\" -> \"org.apache.kafka.common.serialization.StringSerializer\",\n          \"value.serializer\" -> \"org.apache.kafka.common.serialization.StringSerializer\",\n          \"bootstrap.servers\" -> brokerList\n        ).asJava\n      )\n\n\nval consumer = new KafkaConsumer[String,String](\n        Map[String,Object](\n          \"key.deserializer\" -> \"org.apache.kafka.common.serialization.StringDeserializer\",\n          \"value.deserializer\" -> \"org.apache.kafka.common.serialization.StringDeserializer\",\n          \"bootstrap.servers\" -> brokerList,\n          \"group.id\" -> \"zeppelin\",\n          \"auto.commit\" -> new java.lang.Boolean(true)\n        ).asJava\n    )\n        \nconsumer.subscribe(List(outTopic).asJava)\n\n\ndef send(msg:String):Unit = {\n    producer.send(new ProducerRecord(inTopic, msg)).get\n    producer.flush\n}\n\n    \n\ndef poll():List[String] = consumer.poll(10000).asScala.toList.map(_.value())\n\n\n","user":"admin","dateUpdated":"2019-02-09T20:08:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"inTopic: String = in\noutTopic: String = out\nbrokerList: String = ip-10-0-10-152:6667,ip-10-0-10-251:6667\nproducer: org.apache.kafka.clients.producer.KafkaProducer[String,String] = org.apache.kafka.clients.producer.KafkaProducer@65c3ca7a\nconsumer: org.apache.kafka.clients.consumer.KafkaConsumer[String,String] = org.apache.kafka.clients.consumer.KafkaConsumer@5cb5aa04\nsend: (msg: String)Unit\npoll: ()List[String]\n"}]},"apps":[],"jobName":"paragraph_1549716871459_-1200469169","id":"20190209-125431_1648733422","dateCreated":"2019-02-09T12:54:31+0000","dateStarted":"2019-02-09T20:08:20+0000","dateFinished":"2019-02-09T20:08:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:233"},{"text":"send(\"\"\"{\"NewParcel\":{\"msgKey\":\"1\",\"parcelId\":\"a\",\"ts\":1549738324093,\"sender\":\"Dominic\",\"recipient\":\"Stefan\"}}\"\"\")\n","user":"admin","dateUpdated":"2019-02-09T20:07:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1549717074504_-1263327026","id":"20190209-125754_284829844","dateCreated":"2019-02-09T12:57:54+0000","dateStarted":"2019-02-09T20:07:06+0000","dateFinished":"2019-02-09T20:07:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:234"},{"user":"admin","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549742486366_1253982116","id":"20190209-200126_1972134553","dateCreated":"2019-02-09T20:01:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4105","text":"send(\"\"\"{\"DistributionHop\":{\"msgKey\":\"2\",\"parcelId\":\"a\",\"ts\":1549738324094,\"distributionCenter\":\"Frauenfeld\"}}\"\"\")","dateUpdated":"2019-02-09T20:07:07+0000","dateFinished":"2019-02-09T20:07:08+0000","dateStarted":"2019-02-09T20:07:07+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"admin","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549742544199_-1826361979","id":"20190209-200224_252412823","dateCreated":"2019-02-09T20:02:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4186","text":"send(\"\"\"{\"Delivery\":{\"msgKey\":\"3\",\"parcelId\":\"a\",\"ts\":1549738324095,\"accepted\":true}}\"\"\")","dateUpdated":"2019-02-09T20:14:24+0000","dateFinished":"2019-02-09T20:14:24+0000","dateStarted":"2019-02-09T20:14:24+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"println(poll())","user":"admin","dateUpdated":"2019-02-09T20:14:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"List({\"MessageSuccess\":{\"msgKey\":\"3\"}})\n"}]},"apps":[],"jobName":"paragraph_1549717845679_1587035783","id":"20190209-131045_361456969","dateCreated":"2019-02-09T13:10:45+0000","dateStarted":"2019-02-09T20:14:35+0000","dateFinished":"2019-02-09T20:14:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:235"},{"text":"%jdbc\n--drop table states;\ncreate table if not exists states (demarcator varchar, parcel_id varchar, ts bigint, a_one varchar, a_two varchar)","user":"admin","dateUpdated":"2019-02-09T20:07:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : 0"}]},"apps":[],"jobName":"paragraph_1549736252551_-144707864","id":"20190209-181732_1029363031","dateCreated":"2019-02-09T18:17:32+0000","dateStarted":"2019-02-09T20:06:58+0000","dateFinished":"2019-02-09T20:06:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:236"},{"text":"%jdbc\nselect * from states order by parcel_id, ts desc","user":"admin","dateUpdated":"2019-02-09T20:14:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"demarcator":"string","parcel_id":"string","ts":"string","a_one":"string","a_two":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"demarcator\tparcel_id\tts\ta_one\ta_two\ndelivered\ta\t1549738324095\tStefan\tnull\nindelivery\ta\t1549738324094\tFrauenfeld\tStefan\nnew\ta\t1549738324093\tDominic\tStefan\n"}]},"apps":[],"jobName":"paragraph_1549738394335_-1057795496","id":"20190209-185314_1811359769","dateCreated":"2019-02-09T18:53:14+0000","dateStarted":"2019-02-09T20:14:45+0000","dateFinished":"2019-02-09T20:14:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:237"},{"text":"producer.close\nconsumer.close","user":"admin","dateUpdated":"2019-02-09T19:24:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549718365205_-1536652939","id":"20190209-131925_1850454752","dateCreated":"2019-02-09T13:19:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:238","dateFinished":"2019-02-09T19:24:12+0000","dateStarted":"2019-02-09T19:24:12+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"","user":"admin","dateUpdated":"2019-02-09T18:53:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"k":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"k\n"}]},"apps":[],"jobName":"paragraph_1549720228230_-515453740","id":"20190209-135028_727802418","dateCreated":"2019-02-09T13:50:28+0000","dateStarted":"2019-02-09T13:53:57+0000","dateFinished":"2019-02-09T13:53:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:239"},{"text":"%jdbc\n","user":"admin","dateUpdated":"2019-02-09T13:50:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1549720236667_-1313675098","id":"20190209-135036_1280684859","dateCreated":"2019-02-09T13:50:36+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:240"}],"name":"Tooling/Day3Helper","id":"2E2J9QYMX","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"jdbc:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}